{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chanchinghei/Library/Mobile Documents/com~apple~CloudDocs/Documents/Work/Fully Remote \\uD83C\\uDF0E/Options/Coding/Projects/shop/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/chanchinghei/Library/Mobile Documents/com~apple~CloudDocs/Documents/Work/Fully Remote \\uD83C\\uDF0E/Options/Coding/Projects/shop/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/chanchinghei/Library/Mobile Documents/com~apple~CloudDocs/Documents/Work/Fully Remote \\uD83C\\uDF0E/Options/Coding/Projects/shop/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Component,useState}from\"react\";import\"./cart.scss\";import DeleteOutlinedIcon from\"@mui/icons-material/DeleteOutlined\";import{useDispatch,useSelector}from\"react-redux\";import{removeItem,resetCart}from\"../../redux/cartReducer\";import{loadStripe}from\"@stripe/stripe-js\";import{makeRequest}from\"../../makeRequest\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faXmark}from\"@fortawesome/free-solid-svg-icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Cart=function Cart(){var products=useSelector(function(state){return state.cart.products;});var dispatch=useDispatch();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),toggle=_useState2[0],setToggle=_useState2[1];var totalPrice=function totalPrice(){var total=0;products.forEach(function(item){return total+=item.quantity*item.price;});return total.toFixed(2);};var stripePromise=loadStripe(\"pk_test_51MwtCaHoWPMOpNg23E34n3adYB0xIc9jgAAZjHT4cbGBZm0YieD1noccgvtnNAnbdaTQTqkRwYCqJZ1WmQIaFgfM00wGqUBHaL\");var handlePayment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stripe,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return stripePromise;case 3:stripe=_context.sent;_context.next=6;return makeRequest.post(\"/orders\",{products:products});case 6:res=_context.sent;_context.next=9;return stripe.redirectToCheckout({sessionId:res.data.stripeSession.id});case 9:_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function handlePayment(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:toggle&&/*#__PURE__*/_jsxs(\"div\",{className:\"cart\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cartHeader\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Products in your cart \"}),/*#__PURE__*/_jsx(\"button\",{className:\"cartCloseBtn\",onClick:function onClick(){return setToggle(!toggle);},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faXmark})})]}),products===null||products===void 0?void 0:products.map(function(item){var _item$desc;return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"img\",{src:process.env.REACT_APP_UPLOAD_URL+item.img,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsx(\"h1\",{children:item.title}),/*#__PURE__*/_jsx(\"p\",{children:(_item$desc=item.desc)===null||_item$desc===void 0?void 0:_item$desc.substring(0,30)}),/*#__PURE__*/_jsxs(\"div\",{className:\"price\",children:[item.quantity,\" x \\xA3\",item.price]})]}),/*#__PURE__*/_jsx(DeleteOutlinedIcon,{className:\"delete\",onClick:function onClick(){return dispatch(removeItem(item.id));}})]},item.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"SUBTOTAL\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\xA3\",totalPrice()]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePayment,className:\"checkoutBtn\",children:\"PROCEED TO CHECKOUT\"}),/*#__PURE__*/_jsx(\"span\",{className:\"reset\",onClick:function onClick(){return dispatch(resetCart());},children:\"RESET CART\"})]})});};export default Cart;","map":{"version":3,"names":["React","Component","useState","DeleteOutlinedIcon","useDispatch","useSelector","removeItem","resetCart","loadStripe","makeRequest","FontAwesomeIcon","faXmark","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","products","state","cart","dispatch","_useState","_useState2","_slicedToArray","toggle","setToggle","totalPrice","total","forEach","item","quantity","price","toFixed","stripePromise","handlePayment","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","stripe","res","wrap","_callee$","_context","prev","next","sent","post","redirectToCheckout","sessionId","data","stripeSession","id","t0","console","log","stop","apply","arguments","children","className","onClick","icon","map","_item$desc","src","process","env","REACT_APP_UPLOAD_URL","img","alt","title","desc","substring"],"sources":["/Users/chanchinghei/Library/Mobile Documents/com~apple~CloudDocs/Documents/Work/Fully Remote ðŸŒŽ/Options/Coding/Projects/shop/client/src/components/Cart/Cart.jsx"],"sourcesContent":["import React, { Component, useState } from \"react\";\nimport \"./cart.scss\";\nimport DeleteOutlinedIcon from \"@mui/icons-material/DeleteOutlined\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { removeItem, resetCart } from \"../../redux/cartReducer\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { makeRequest } from \"../../makeRequest\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faXmark } from \"@fortawesome/free-solid-svg-icons\";\n\nconst Cart = () => {\n  const products = useSelector((state) => state.cart.products);\n  const dispatch = useDispatch();\n\n  const [toggle, setToggle] = useState(true);\n\n  const totalPrice = () => {\n    let total = 0;\n    products.forEach((item) => (total += item.quantity * item.price));\n    return total.toFixed(2);\n  };\n\n  const stripePromise = loadStripe(\n    \"pk_test_51MwtCaHoWPMOpNg23E34n3adYB0xIc9jgAAZjHT4cbGBZm0YieD1noccgvtnNAnbdaTQTqkRwYCqJZ1WmQIaFgfM00wGqUBHaL\"\n  );\n\n  const handlePayment = async () => {\n    try {\n      const stripe = await stripePromise;\n\n      const res = await makeRequest.post(\"/orders\", {\n        products,\n      });\n\n      await stripe.redirectToCheckout({\n        sessionId: res.data.stripeSession.id,\n      });\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return (\n    <>\n      {toggle && (\n        <div className=\"cart\">\n          <div className=\"cartHeader\">\n            <h1>Products in your cart </h1>\n            <button className=\"cartCloseBtn\" onClick={() => setToggle(!toggle)}>\n              <FontAwesomeIcon icon={faXmark} />\n            </button>\n          </div>\n\n          {products?.map((item) => (\n            <div className=\"item\" key={item.id}>\n              <img src={process.env.REACT_APP_UPLOAD_URL + item.img} alt=\"\" />\n\n              <div className=\"details\">\n                <h1>{item.title}</h1>\n                <p>{item.desc?.substring(0, 30)}</p>\n                <div className=\"price\">\n                  {item.quantity} x Â£{item.price}\n                </div>\n              </div>\n              <DeleteOutlinedIcon\n                className=\"delete\"\n                onClick={() => dispatch(removeItem(item.id))}\n              />\n            </div>\n          ))}\n\n          <div className=\"total\">\n            <span>SUBTOTAL</span>\n            <span>Â£{totalPrice()}</span>\n          </div>\n          <button onClick={handlePayment} className=\"checkoutBtn\">\n            PROCEED TO CHECKOUT\n          </button>\n          <span className=\"reset\" onClick={() => dispatch(resetCart())}>\n            RESET CART\n          </span>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default Cart;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}