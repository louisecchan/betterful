{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chanchinghei/Library/Mobile Documents/com~apple~CloudDocs/Documents/Work/Fully Remote \\uD83C\\uDF0E/Options/Coding/Projects/shop/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/chanchinghei/Library/Mobile Documents/com~apple~CloudDocs/Documents/Work/Fully Remote \\uD83C\\uDF0E/Options/Coding/Projects/shop/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import\"./cart.scss\";import DeleteOutlinedIcon from\"@mui/icons-material/DeleteOutlined\";import{useDispatch,useSelector}from\"react-redux\";import{removeItem,resetCart}from\"../../redux/cartReducer\";import{loadStripe}from\"@stripe/stripe-js\";import{makeRequest}from\"../../makeRequest\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Cart=function Cart(){var products=useSelector(function(state){return state.cart.products;});var dispatch=useDispatch();var totalPrice=function totalPrice(){var total=0;products.forEach(function(item){return total+=item.quantity*item.price;});return total.toFixed(2);};var stripePromise=loadStripe(\"pk_test_51MwtCaHoWPMOpNg23E34n3adYB0xIc9jgAAZjHT4cbGBZm0YieD1noccgvtnNAnbdaTQTqkRwYCqJZ1WmQIaFgfM00wGqUBHaL\");var handlePayment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stripe,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return stripePromise;case 3:stripe=_context.sent;_context.next=6;return makeRequest.post(\"/orders\",{products:products});case 6:res=_context.sent;_context.next=9;return stripe.redirectToCheckout({sessionId:res.data.stripeSession.id});case 9:_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function handlePayment(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"cart\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Products in your cart\"}),products===null||products===void 0?void 0:products.map(function(item){var _item$desc;return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"img\",{src:process.env.REACT_APP_UPLOAD_URL+item.img,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsx(\"h1\",{children:item.title}),/*#__PURE__*/_jsx(\"p\",{children:(_item$desc=item.desc)===null||_item$desc===void 0?void 0:_item$desc.substring(0,100)}),/*#__PURE__*/_jsxs(\"div\",{className:\"price\",children:[item.quantity,\" x $\",item.price]})]}),/*#__PURE__*/_jsx(DeleteOutlinedIcon,{className:\"delete\",onClick:function onClick(){return dispatch(removeItem(item.id));}})]},item.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"SUBTOTAL\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",totalPrice()]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePayment,children:\"PROCEED TO CHECKOUT\"}),/*#__PURE__*/_jsx(\"span\",{className:\"reset\",onClick:function onClick(){return dispatch(resetCart());},children:\"RESET CART\"})]});};export default Cart;","map":{"version":3,"names":["React","DeleteOutlinedIcon","useDispatch","useSelector","removeItem","resetCart","loadStripe","makeRequest","jsx","_jsx","jsxs","_jsxs","Cart","products","state","cart","dispatch","totalPrice","total","forEach","item","quantity","price","toFixed","stripePromise","handlePayment","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","stripe","res","wrap","_callee$","_context","prev","next","sent","post","redirectToCheckout","sessionId","data","stripeSession","id","t0","console","log","stop","apply","arguments","className","children","map","_item$desc","src","process","env","REACT_APP_UPLOAD_URL","img","alt","title","desc","substring","onClick"],"sources":["/Users/chanchinghei/Library/Mobile Documents/com~apple~CloudDocs/Documents/Work/Fully Remote ðŸŒŽ/Options/Coding/Projects/shop/client/src/components/Cart/Cart.jsx"],"sourcesContent":["import React from \"react\";\nimport \"./cart.scss\";\nimport DeleteOutlinedIcon from \"@mui/icons-material/DeleteOutlined\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { removeItem, resetCart } from \"../../redux/cartReducer\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { makeRequest } from \"../../makeRequest\";\n\nconst Cart = () => {\n  const products = useSelector((state) => state.cart.products);\n  const dispatch = useDispatch();\n\n  const totalPrice = () => {\n    let total = 0;\n    products.forEach((item) => (total += item.quantity * item.price));\n    return total.toFixed(2);\n  };\n\n  const stripePromise = loadStripe(\n    \"pk_test_51MwtCaHoWPMOpNg23E34n3adYB0xIc9jgAAZjHT4cbGBZm0YieD1noccgvtnNAnbdaTQTqkRwYCqJZ1WmQIaFgfM00wGqUBHaL\"\n  );\n\n  const handlePayment = async () => {\n    try {\n      const stripe = await stripePromise;\n\n      const res = await makeRequest.post(\"/orders\", {\n        products,\n      });\n\n      await stripe.redirectToCheckout({\n        sessionId: res.data.stripeSession.id,\n      });\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return (\n    <div className=\"cart\">\n      <h1>Products in your cart</h1>\n      {products?.map((item) => (\n        <div className=\"item\" key={item.id}>\n          <img src={process.env.REACT_APP_UPLOAD_URL + item.img} alt=\"\" />\n          <div className=\"details\">\n            <h1>{item.title}</h1>\n            <p>{item.desc?.substring(0, 100)}</p>\n            {/* if there's no description, no need to execute the substring function */}\n            <div className=\"price\">\n              {item.quantity} x ${item.price}\n            </div>\n          </div>\n          <DeleteOutlinedIcon\n            className=\"delete\"\n            onClick={() => dispatch(removeItem(item.id))}\n          />\n        </div>\n      ))}\n      <div className=\"total\">\n        <span>SUBTOTAL</span>\n        <span>${totalPrice()}</span>\n      </div>\n      <button onClick={handlePayment}>PROCEED TO CHECKOUT</button>\n      <span className=\"reset\" onClick={() => dispatch(resetCart())}>\n        RESET CART\n      </span>\n    </div>\n  );\n};\n\nexport default Cart;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}